USE myfirstDB;

CREATE TABLE transfer_log
( log_id    INTEGER NOT NULL PRIMARY KEY,
  log_ts    TIMESTAMP NOT NULL,
  from_user VARCHAR(50) NOT NULL,
  to_user   VARCHAR(50),
  type      VARCHAR(10) NOT NULL,
  amount    NUMERIC(10) NOT NULL
);

INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (1,'2019-01-02 10:31:40','62221234567890',NULL,'存款',50000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (2,'2019-01-02 10:32:15','62221234567890',NULL,'存款',100000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (3,'2019-01-03 08:14:29','62221234567890','62226666666666','转账',200000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (4,'2019-01-05 13:55:38','62221234567890','62226666666666','转账',150000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (5,'2019-01-07 20:00:31','62221234567890','62227777777777','转账',300000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (6,'2019-01-09 17:28:07','62221234567890','62227777777777','转账',500000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (7,'2019-01-10 07:46:02','62221234567890','62227777777777','转账',100000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (8,'2019-01-11 09:36:53','62221234567890',NULL,'存款',40000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (9,'2019-01-12 07:10:01','62221234567890','62228888888881','转账',10000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (10,'2019-01-12 07:11:12','62221234567890','62228888888882','转账',8000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (11,'2019-01-12 07:12:36','62221234567890','62228888888883','转账',5000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (12,'2019-01-12 07:13:55','62221234567890','62228888888884','转账',6000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (13,'2019-01-12 07:14:24','62221234567890','62228888888885','转账',7000);
INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (14,'2019-01-21 12:11:16','62221234567890','62228888888885','转账',70000);

SET SQL_SAFE_UPDATES = 0;
UPDATE transfer_log SET type = 'Deposit' WHERE type = '存款';
UPDATE transfer_log SET type = 'Transfer' WHERE type = '转账';

INSERT INTO transfer_log (log_id,log_ts,from_user,to_user,type,amount) VALUES (15, '2019-01-28 04:54:41', '62855244383201', '62258375595770', 'Transfer', 66683), (16, '2019-01-06 09:51:56', '63137841213257', '63085828804091', 'Deposit', 58368), (17, '2019-01-08 00:42:35', '62999147891628', '63143310808150', 'Deposit', 51122), (18, '2019-01-04 20:34:21', '62304219182501', '62873088934800', 'Deposit', 68680), (19, '2019-01-06 11:29:32', '62970212206867', '62559966685992', 'Deposit', 41399), (20, '2019-01-20 12:06:26', '62926758791724', '63033338902865', 'Deposit', 5261), (21, '2019-01-03 19:10:19', '62360436339710', '62686613319804', 'Deposit', 97296), (22, '2019-01-12 01:35:10', '62477942983737', '62619308733935', 'Deposit', 16426), (23, '2019-01-29 00:45:06', '62620443180129', '62269689314440', 'Deposit', 67528), (24, '2019-01-06 12:25:37', '62667729117117', '63169643664953', 'Deposit', 49155), (25, '2019-01-21 04:46:49', '62562325451094', '62669132495473', 'Transfer', 73998), (26, '2019-01-04 18:20:27', '62697465942062', '62358936939680', 'Deposit', 31788), (27, '2019-01-04 07:43:52', '62364489749397', '62990761656086', 'Deposit', 45385), (28, '2019-01-26 22:18:37', '62855250712671', '62738414672027', 'Deposit', 75036), (29, '2019-01-13 06:27:18', '62336957672860', '62301805359215', 'Deposit', 57648), (30, '2019-01-15 04:53:18', '62247004307954', '62958328155964', 'Transfer', 93281), (31, '2019-01-04 13:07:18', '62592994846286', '62249633377618', 'Deposit', 32146), (32, '2019-01-03 14:38:19', '62415982386354', '62822212524771', 'Transfer', 2208), (33, '2019-01-16 13:53:53', '62795951117834', '63089080713607', 'Transfer', 28507), (34, '2019-01-08 10:00:53', '62485228771466', '63102240280753', 'Deposit', 31544), (35, '2019-01-23 02:24:55', '62233730051485', '62305085257032', 'Deposit', 83929), (36, '2019-01-08 02:02:06', '62738334483597', '62283460778818', 'Deposit', 49045), (37, '2019-01-24 01:33:10', '62971724587817', '62323627058818', 'Transfer', 98259), (38, '2019-01-27 23:34:41', '62392751007099', '62852794840784', 'Transfer', 54619), (39, '2019-01-23 20:02:37', '62424238477067', '63207395184046', 'Transfer', 91714), (40, '2019-01-08 13:31:07', '62609399886721', '62356463487949', 'Transfer', 84856), (41, '2019-01-18 00:08:07', '62602131934204', '63191916678036', 'Transfer', 69721), (42, '2019-01-22 00:43:14', '62630481273301', '62818529642498', 'Deposit', 16408), (43, '2019-01-07 11:08:12', '62945219772153', '62339850782376', 'Deposit', 9876), (44, '2019-01-29 17:27:12', '63201439556480', '63071064553190', 'Deposit', 20689), (45, '2019-01-13 03:22:22', '62453699730287', '63165461521924', 'Deposit', 17277), (46, '2019-01-26 00:37:43', '63157151003803', '62330713317839', 'Transfer', 51353), (47, '2019-01-14 22:01:16', '62460857384182', '62776622956573', 'Transfer', 46820), (48, '2019-01-29 03:48:43', '62378941770924', '62674437355580', 'Transfer', 39278), (49, '2019-01-03 06:28:24', '62698917379975', '63035277589562', 'Deposit', 71832), (50, '2019-01-08 10:11:58', '63111149217749', '62881639728951', 'Transfer', 60731), (51, '2019-01-11 08:37:31', '63174167151836', '62645222422768', 'Deposit', 76880), (52, '2019-01-21 17:34:46', '62264784487996', '62320442773631', 'Deposit', 98903), (53, '2019-01-17 08:33:28', '62463863336620', '62462465584378', 'Transfer', 24153), (54, '2019-01-13 17:03:06', '62814565158688', '63121629339297', 'Deposit', 95804), (55, '2019-01-09 05:33:24', '62347216433672', '62599729701285', 'Transfer', 57906), (56, '2019-01-02 07:32:04', '62633814342228', '63213070687673', 'Transfer', 77031), (57, '2019-01-24 01:43:47', '63204025340187', '62872601223484', 'Deposit', 76036), (58, '2019-01-15 02:16:37', '62631885635803', '62770338944322', 'Transfer', 81303), (59, '2019-01-14 12:54:39', '62866226021385', '62661394232679', 'Deposit', 81264), (60, '2019-01-06 15:19:27', '63027673309572', '62954029646468', 'Transfer', 67414), (61, '2019-01-17 19:40:25', '63176876258973', '62817835950588', 'Deposit', 79809), (62, '2019-01-16 07:43:53', '62682302756115', '62973843904103', 'Transfer', 29938), (63, '2019-01-08 23:01:56', '62320176089758', '62514375109768', 'Deposit', 35269), (64, '2019-01-27 07:56:10', '62288866980055', '62320398104241', 'Transfer', 35002);

#make a change by calling the primary key. See if we can catch this later.
UPDATE transfer_log SET to_user = '62855244383201' WHERE log_id = 15;